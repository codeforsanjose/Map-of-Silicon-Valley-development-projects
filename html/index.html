<!doctype html>
<html class="no-js" lang="">

<head>
  <meta charset="utf-8">
  <title>App</title>
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css" integrity="sha256-l85OmPOjvil/SOvVt3HnSSjzF1TUMyT9eV0c2BzEGzU=" crossorigin="anonymous" />
  <!-- Mapbox -->
  <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v1.4.1/mapbox-gl.js'></script>
  <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v1.4.1/mapbox-gl.css' rel='stylesheet' />

  <style>
  /* Opinionated Defaults */
  html{color:#222;font-size:1em;line-height:1.4}::-moz-selection{background:#b3d4fc;text-shadow:none}::selection{background:#b3d4fc;text-shadow:none}hr{display:block;height:1px;border:0;border-top:1px solid #ccc;margin:1em 0;padding:0}audio,canvas,iframe,img,svg,video{vertical-align:middle}fieldset{border:0;margin:0;padding:0}textarea{resize:vertical}@media print{*,*:before,*:after{background:transparent!important;color:#000!important;-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}a,a:visited{text-decoration:underline}a[href]:after{content:" (" attr(href) ")"}abbr[title]:after{content:" (" attr(title) ")"}a[href^="#"]:after,a[href^="javascript:"]:after{content:""}pre{white-space:pre-wrap!important}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}p,h2,h3{orphans:3;widows:3}h2,h3{page-break-after:avoid}}
  </style>

  <style>

  /* Add your app styling here */

  body {
    overflow: hidden;
  }

  #map {
    position:absolute; top:0; bottom:0; width:100%; z-index: 1;
  }

   .sidebar {
    position: absolute;
    right: 1em;
    top: 1em;
    bottom: 1em;
    width: 25vw;
    min-width: 12em;
    z-index: 100;
    transform: translateX(0);
    transition: transform 0.4s ease-in-out;
  }

  .sidebar.hidden {
    transform: translateX(200%);
  }
  .content {
    height: 100%;
    position: relative;
    background: #fff;
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
    padding: 10px 10px 15px;
    pointer-events: auto;
    opacity: 1;

  }

  .info {
  }

  .close-btn {
    position: absolute;
    right: 0;
    top: 0;
    border: 0;
    border-radius: 0 3px 0 0;
    cursor: pointer;
    background-color: transparent;
  }

  .fade-in {
    animation: fadeIn ease 0.5s;
    -webkit-animation: fadeIn ease 0.5s;
    -moz-animation: fadeIn ease 0.5s;
    -o-animation: fadeIn ease 0.5s;
    -ms-animation: fadeIn ease 0.5s;
  }


  @keyframes fadeIn{
    0% {
      opacity:0;
    }
    100% {
      opacity:1;
    }
  }

  @-moz-keyframes fadeIn {
    0% {
      opacity:0;
    }
    100% {
      opacity:1;
    }
  }

  @-webkit-keyframes fadeIn {
    0% {
      opacity:0;
    }
    100% {
      opacity:1;
    }
  }

  @-o-keyframes fadeIn {
    0% {
      opacity:0;
    }
    100% {
      opacity:1;
    }
  }

  @-ms-keyframes fadeIn {
    0% {
      opacity:0;
    }
    100% {
      opacity:1;
    }
  }
  </style>

  <meta name="theme-color" content="#fafafa">
</head>

<body>
  <!--[if IE]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->

  <!-- Add your site or application content here -->
  <div id="map">

  </div>
  <div class="sidebar hidden">
    <div class="content">
      <button class="close-btn">X</button>
      <div class="info fade-in"></div>
    </div>
  </div>


  <script>
    // Avoid `console` errors in browsers that lack a console.
    (function(){var e;var d=function(){};var b=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeline","timelineEnd","timeStamp","trace","warn"];var c=b.length;var a=(window.console=window.console||{});while(c--){e=b[c];if(!a[e]){a[e]=d}}}());
  </script>

  <script>
    const state = {
      sidebar_open: false
    }

    mapboxgl.accessToken = 'pk.eyJ1Ijoic3VubnltdWkiLCJhIjoiY2sxcjhpMzY0MDJubTNtbzdic2pmZ29kYiJ9.i5wxeYoDcJponU7Pc3b-FQ';

    const sidebar = document.querySelector('.sidebar');
    const sidebar_info = document.querySelector('.info');
    const close_btn = document.querySelector('.close-btn');

    const map = new mapboxgl.Map({
      container: 'map',
      style: 'mapbox://styles/sunnymui/ck1r9coyy0dxn1cpe1tgues9x',
      center: [-121.849829, 37.380864],
      zoom: 10
    });

    map.on('load', () => {

      // When a click event occurs on a feature in the places layer, open a popup at the
      // location of the feature, with description HTML from its properties.
      map.on('click', 'projects', function (e) {
        const currentProject = e.features[0];

        const {place_name, Completion_Date, Project_Name, Contact} = currentProject.properties;

        // template for the sidebar content
        // const content = `
        //   <h3>${Project_Name}</h3>
        //   <p>
        //     ${place_name}
        //   </p>
        //   <ul>
        //     <li>
        //       Expected completion: ${Completion_Date}
        //     </li>
        //     <li>
        //       Contact Info: ${Contact}
        //     </li>
        //   </ul>`

        const title = document.createElement('h3');

        // clear any content that was there
        while (sidebar_info.firstChild) {
            sidebar_info.firstChild.remove();
        }

        // don't hide sidebar if already open, animate change instead
        if (state.sidebar_open) {
          // clear animation with an override
          sidebar_info.style.animation ='none';
          // trigger reflow so css animation can play again
          void sidebar_info.offsetWidth;
          // allow animation to play again
          sidebar_info.style.animation = null;
        } else {
          state.sidebar_open = true;
          sidebar.classList.toggle('hidden');
        }

        // add the info to the sidebar
        for (let property in currentProject.properties) {
          if (property === 'Project_Name') {
            title.textContent = Project_Name;
            sidebar_info.prepend(title);
          } else {
            let paragraph = document.createElement('p');
            paragraph.textContent = currentProject.properties[property];
            sidebar_info.append(paragraph);
          }
        }

      });

      // hide the sidebar on click
      close_btn.addEventListener('click', () => {
        state.sidebar_open = false;
        sidebar.classList.toggle('hidden');
      });

      // Change the cursor to a pointer when the mouse is over the places layer.
      map.on('mouseenter', 'projects', function () {
        map.getCanvas().style.cursor = 'pointer';
      });

      // Change it back to a pointer when it leaves.
      map.on('mouseleave', 'projects', function () {
        map.getCanvas().style.cursor = '';
      });
    });

  </script>

</body>

</html>
